# Searches for an AWESOMIUM installation
#
# Defines:
#
#   AWESOMIUM_FOUND         True if AWESOMIUM was found, else false
#   AWESOMIUM_LIBRARIES     Libraries to link
#   AWESOMIUM_INCLUDE_DIRS  The directories containing the header files
#
# To specify an additional directory to search, set AWESOMIUM_ROOT.
#
# Author: Siddhartha Chaudhuri, 2008
#

SET(AWESOMIUM_FOUND FALSE)

IF(${CMAKE_SYSTEM_NAME} STREQUAL "Darwin")  # OS X

  SET(AWESOMIUM_FRAMEWORKS ${AWESOMIUM_ROOT}/Frameworks/Awesomium.framework)
  IF(AWESOMIUM_FRAMEWORKS)
    LIST(GET AWESOMIUM_FRAMEWORKS 0 AWESOMIUM_LIBRARIES)
    SET(AWESOMIUM_INCLUDE_DIRS ${AWESOMIUM_LIBRARIES}/Headers)
    SET(AWESOMIUM_LDFLAGS -F${AWESOMIUM_LIBRARIES}/Frameworks -framework Awesomium)
    SET(AWESOMIUM_LIBRARY_DIRS)
    SET(AWESOMIUM_LIBRARIES)
    SET(AWESOMIUM_CFLAGS)

    SET(AWESOMIUM_FOUND TRUE)
  ENDIF(AWESOMIUM_FRAMEWORKS)

ELSE(${CMAKE_SYSTEM_NAME} STREQUAL "Darwin")  # Windows, Linux etc

  SET(AWESOMIUM_INCLUDE_DIRS ${AWESOMIUM_ROOT}/include)

  IF(AWESOMIUM_INCLUDE_DIRS)
    SET(AWESOMIUM_LIBRARY_DIRS ${AWESOMIUM_INCLUDE_DIRS})
    IF("${AWESOMIUM_LIBRARY_DIRS}" MATCHES "/include$")
      # Strip off the trailing "/include" in the path.
      GET_FILENAME_COMPONENT(AWESOMIUM_LIBRARY_DIRS ${AWESOMIUM_LIBRARY_DIRS} PATH)
    ENDIF("${AWESOMIUM_LIBRARY_DIRS}" MATCHES "/include$")

    IF(EXISTS "${AWESOMIUM_LIBRARY_DIRS}/lib")
      SET(AWESOMIUM_LIBRARY_DIRS ${AWESOMIUM_LIBRARY_DIRS}/lib)
    ENDIF(EXISTS "${AWESOMIUM_LIBRARY_DIRS}/lib")

    IF(WIN32)  # Windows
      FIND_LIBRARY(AWESOMIUM_DEBUG_LIBRARY   NAMES Awesomiumd Awesomium_d libAwesomiumd libAwesomium_d
                   PATH_SUFFIXES "" Debug   PATHS ${AWESOMIUM_LIBRARY_DIRS} NO_DEFAULT_PATH)
      FIND_LIBRARY(AWESOMIUM_RELEASE_LIBRARY NAMES Awesomium libAwesomium
                   PATH_SUFFIXES "" Release PATHS ${AWESOMIUM_LIBRARY_DIRS} NO_DEFAULT_PATH)

      SET(AWESOMIUM_LIBRARIES)
      IF(AWESOMIUM_DEBUG_LIBRARY AND AWESOMIUM_RELEASE_LIBRARY)
        SET(AWESOMIUM_LIBRARIES debug ${AWESOMIUM_DEBUG_LIBRARY} optimized ${AWESOMIUM_RELEASE_LIBRARY})
      ELSEIF(AWESOMIUM_DEBUG_LIBRARY)
        SET(AWESOMIUM_LIBRARIES ${AWESOMIUM_DEBUG_LIBRARY})
      ELSEIF(AWESOMIUM_RELEASE_LIBRARY)
        SET(AWESOMIUM_LIBRARIES ${AWESOMIUM_RELEASE_LIBRARY})
      ENDIF(AWESOMIUM_DEBUG_LIBRARY AND AWESOMIUM_RELEASE_LIBRARY)
    ELSE(WIN32)  # Linux etc
      FIND_LIBRARY(AWESOMIUM_LIBRARIES NAMES awesomium PATHS ${AWESOMIUM_LIBRARY_DIRS} NO_DEFAULT_PATH)
    ENDIF(WIN32)

    IF(AWESOMIUM_LIBRARIES)
      SET(AWESOMIUM_FOUND TRUE)
    ENDIF(AWESOMIUM_LIBRARIES)
  ENDIF(AWESOMIUM_INCLUDE_DIRS)

ENDIF(${CMAKE_SYSTEM_NAME} STREQUAL "Darwin")

IF(AWESOMIUM_FOUND)
  IF(NOT AWESOMIUM_FIND_QUIETLY)
    IF(${CMAKE_SYSTEM_NAME} STREQUAL "Darwin")
      MESSAGE(STATUS "Found Awesomium: ${AWESOMIUM_LDFLAGS}")
    ELSE(${CMAKE_SYSTEM_NAME} STREQUAL "Darwin")
      MESSAGE(STATUS "Found Awesomium: headers at ${AWESOMIUM_INCLUDE_DIRS}, libraries at ${AWESOMIUM_LIBRARIES}")
    ENDIF(${CMAKE_SYSTEM_NAME} STREQUAL "Darwin")
  ENDIF(NOT AWESOMIUM_FIND_QUIETLY)
ELSE(AWESOMIUM_FOUND)
  IF(AWESOMIUM_FIND_REQUIRED)
    MESSAGE(FATAL_ERROR "Awesomium not found")
  ENDIF(AWESOMIUM_FIND_REQUIRED)
ENDIF(AWESOMIUM_FOUND)
